<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2017 Evolveum
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<resource oid="04afeda6-394b-11e6-8cbe-abf7ff430056"
    xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
    xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
    xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3"
    xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3"
    xmlns:icfc="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/connector-schema-3"
    xmlns:my="http://myself.me/schemas/whatever">

       <name>Sistema Acad√©mico</name>

    <connectorRef type="ConnectorType">
        <filter>
            <q:equal>
            <q:path>c:connectorType</q:path>
              <q:value>org.identityconnectors.databasetable.DatabaseTableConnector</q:value>
            </q:equal>
          </filter>
    </connectorRef>

    <connectorConfiguration>

        <icfc:configurationProperties
        xmlns:icscdbtable="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/bundle/com.evolveum.polygon.connector-databasetable/org.identityconnectors.databasetable.DatabaseTableConnector">
            <icscdbtable:port>5433</icscdbtable:port>
            <icscdbtable:host>192.168.25.6</icscdbtable:host>
            <icscdbtable:user>academico</icscdbtable:user>
            <icscdbtable:password><clearValue>secret</clearValue></icscdbtable:password>
            <icscdbtable:database>academico</icscdbtable:database>
            <icscdbtable:table>estudiantes</icscdbtable:table>
            <icscdbtable:keyColumn>estudiante_id</icscdbtable:keyColumn>
            <icscdbtable:passwordColumn>password</icscdbtable:passwordColumn>
            <icscdbtable:jdbcDriver>org.postgresql.Driver</icscdbtable:jdbcDriver>
            <icscdbtable:jdbcUrlTemplate>jdbc:postgresql://%h:%p/%d</icscdbtable:jdbcUrlTemplate>
            <icscdbtable:enableEmptyString>false</icscdbtable:enableEmptyString>
            <icscdbtable:rethrowAllSQLExceptions>true</icscdbtable:rethrowAllSQLExceptions>
            <icscdbtable:nativeTimestamps>false</icscdbtable:nativeTimestamps>
            <icscdbtable:allNative>false</icscdbtable:allNative>
            <icscdbtable:changeLogColumn>change_timestamp</icscdbtable:changeLogColumn>
            <icscdbtable:datasource></icscdbtable:datasource>
        </icfc:configurationProperties>

    </connectorConfiguration>

    <schemaHandling>
        <objectType>
            <kind>account</kind>
            <displayName>Default Account</displayName>
            <default>true</default>
            <objectClass>ri:AccountObjectClass</objectClass>
            <delineation>
                <objectClass>ri:AccountObjectClass</objectClass>
            </delineation>            
            <focus>
                <type>c:UserType</type>
            </focus>       
            <attribute>
                <ref>icfs:uid</ref>
                <displayName>UUID</displayName>
                <limitations>
                    <minOccurs>0</minOccurs>
                    <access>
                        <read>true</read>
                        <add>true</add>
                        <modify>true</modify>
                    </access>
                </limitations>
                <outbound>
                    <source>
                        <path>$focus/name</path>
                    </source>
                </outbound>                   
                <inbound>
                    <target>
                        <path>c:name</path>
                    </target>
                </inbound>
          
            </attribute>
            <attribute>
                <ref>ri:first_name</ref>
                <displayName>First name</displayName>
                <outbound>
                    <source>
                        <path>$focus/givenName</path>
                    </source>
                </outbound> 
                <inbound>
                    <target>
                        <path>c:givenName</path>
                    </target>
                </inbound>
                             
            </attribute>
            <attribute>
                <ref>ri:last_name</ref>
                <displayName>Last name</displayName>
                <outbound>
                    <source>
                        <path>$focus/familyName</path>
                    </source>
                </outbound>
                <inbound>
                    <target>
                        <path>c:familyName</path>
                    </target>
                </inbound>
            </attribute>
            <attribute>
                <ref>ri:email</ref>
                <outbound>
                    <source>
                        <path>$focus/emailAddress</path>
                    </source>
                </outbound>
                <inbound>
                    <target>
                        <path>c:emailAddress</path>
                    </target>
                </inbound>
            </attribute>
            <attribute>
                <ref>ri:locality</ref>
                <outbound>
                    <source>
                        <path>$focus/locality</path>
                    </source>
                </outbound>
                <inbound>
                    <target>
                        <path>c:locality</path>
                    </target>
                </inbound>
            </attribute>
            <attribute>
                <ref>ri:telephone_number</ref>
                <outbound>
                    <source>
                        <path>$focus/telephoneNumber</path>
                    </source>
                </outbound>
                <inbound>
                    <target>
                        <path>c:telephoneNumber</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="28">
                <ref>ri:program_code</ref>
                <inbound id="29">
                    <target>
                        <path xmlns:gen655="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen655:program_code</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="31">
                <ref>ri:sede</ref>
                <inbound id="46">
                    <target>
                        <path xmlns:gen576="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen576:sede</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="32">
                <ref>ri:modalidad_estudio</ref>
                <inbound id="47">
                    <target>
                        <path xmlns:gen834="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen834:modalidad_estudio</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="33">
                <ref>ri:program_short_name</ref>
                <inbound id="48">
                    <target>
                        <path xmlns:gen546="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen546:program_short_name</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="34">
                <ref>ri:program_name</ref>
                <inbound id="49">
                    <target>
                        <path xmlns:gen359="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen359:program_name</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="35">
                <ref>ri:card_number</ref>
                <inbound id="50">
                    <target>
                        <path xmlns:gen530="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen530:card_number</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="36">
                <ref>ri:contract_expiry_date</ref>
                <inbound id="51">
                    <target>
                        <path xmlns:gen488="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen488:contract_expiry_date</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="37">
                <ref>ri:country</ref>
                <inbound id="52">
                    <target>
                        <path xmlns:gen624="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen624:country</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="38">
                <ref>ri:creation_date</ref>
                <inbound id="53">
                    <target>
                        <path xmlns:gen65="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen65:creation_date</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="39">
                <ref>ri:date_of_birth</ref>
                <inbound id="54">
                    <target>
                        <path xmlns:gen353="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen353:date_of_birth</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="40">
                <ref>ri:emailpro</ref>
                <inbound id="55">
                    <target>
                        <path xmlns:gen905="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen905:emailpro</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="41">
                <ref>ri:sigla_facultad</ref>
                <inbound id="56">
                    <target>
                        <path xmlns:gen232="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen232:sigla_facultad</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="42">
                <ref>ri:gender</ref>
                <inbound id="57">
                    <target>
                        <path xmlns:gen929="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen929:gender</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="43">
                <ref>ri:postal_address</ref>
                <inbound id="58">
                    <target>
                        <path xmlns:gen621="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen621:postal_address</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="44">
                <ref>ri:region</ref>
                <inbound id="59">
                    <target>
                        <path xmlns:gen963="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen963:region</path>
                    </target>
                </inbound>
            </attribute>
            <attribute id="45">
                <ref>ri:username</ref>
                <inbound id="60">
                    <target>
                        <path xmlns:gen18="https://midpoint.upeu.edu.pe/xml/ns/midpoint/schema">c:extension/gen18:username</path>
                    </target>
                </inbound>
            </attribute>

            <activation>
                <administrativeStatus>
                    <inbound/>
                </administrativeStatus>
            </activation>

            <credentials>
                <password>
                    <inbound/>
                </password>
            </credentials>

            <projection>
                <assignmentPolicyEnforcement>none</assignmentPolicyEnforcement>
            </projection>

            <synchronization>
                <reaction>
                    <situation>linked</situation>
                    <actions>
                        <synchronize>
                            <synchronize>true</synchronize>
                        </synchronize>
                    </actions>
                </reaction>
                <reaction>
                    <situation>deleted</situation>
                    <actions>
                        <deleteFocus>
                            <synchronize>true</synchronize>
                        </deleteFocus>
                    </actions>
                </reaction>
                <reaction>
                    <situation>unlinked</situation>
                    <actions>
                        <link>
                            <synchronize>true</synchronize>
                        </link>
                    </actions>
                </reaction>
                <reaction>
                    <situation>unmatched</situation>
                    <actions>
                        <addFocus>
                            <synchronize>true</synchronize>
                            <objectTemplateRef oid="22f83022-b76d-11e9-8a30-6ffc11b23016" type="c:ObjectTemplateType">
                                <!-- User Template -->
                                <!-- Reference to the User Template is here. If the user would be
                                created as a result of this action, it will be created according
                                to this template. -->
                            </objectTemplateRef>
                        </addFocus>
                    </actions>
                </reaction>
            </synchronization>

        </objectType>
    </schemaHandling>

    <capabilities xmlns:cap="http://midpoint.evolveum.com/xml/ns/public/resource/capabilities-3">
        <configured>
            <cap:activation>
                <cap:status>
                    <cap:attribute>ri:disabled</cap:attribute>
                    <cap:enableValue></cap:enableValue>
                    <cap:enableValue>false</cap:enableValue>
                    <cap:disableValue>true</cap:disableValue>
                </cap:status>
            </cap:activation>
        </configured>
    </capabilities>

</resource>
